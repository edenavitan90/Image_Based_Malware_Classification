import xlsxwriter
import os


def data_mapping(path, file_name):
    workbook = xlsxwriter.Workbook("{}.xlsx".format(file_name))
    worksheet = workbook.add_worksheet()

    worksheet.write(0, 0, "No.")
    worksheet.write(0, 1, "Image Path")
    worksheet.write(0, 2, "Malware Family")

    col = 0
    row = 1
    # path == "malimg_paper_dataset_imgs"
    path = os.walk(path)
    for root, directories, files in path:
        for path in os.listdir(root):
            full_path = os.path.join(root, path)
            if os.path.isfile(full_path):
                worksheet.write(row, col, row)
                worksheet.write(row, col + 1, "\\" + full_path)
                worksheet.write(row, col + 2, full_path.split('\\')[len(full_path.split('\\')) - 2])
                #worksheet.write(row, col + 2, full_path.split('\\')[1])
                row += 1

    workbook.close()

#data_mapping(r"resized_images\32x32_malimg_paper_dataset_imgs", "mapped-32x32-data")